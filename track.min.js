var iffy = { jqueryUrl: "http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js", jqueryError: "Iffy will fail to start due to inability to load Jquery as its dependency.", goMessage: "Aye Aye Captain", hasJquery: !1, hasCookieWrapper: !1, callQueue: [], trackers: [], hasGeolocation: !1, elements: null, address: { address: null, city: null, country: null, country_code: null, county: null, postcode: null, road: null, state: null }, locationTypes: { STATE: "state", COUNTRY: "country", CITY: "city" }, addToCallQueue: function (e) { this.callQueue.push(e) }, useLocationTag: function (e, t) { iffy.hasGeolocationAccess().then(function (o) { iffy.isFrom(e, t).then(function (o) { var n = e + "-" + t; jQuery(".iffy-" + n).removeClass("hidden"), jQuery("#iffy-" + n).removeClass("hidden") }) }) }, parseTemplates: function () { jQuery.each(iffy.elements, function (e, t) { jQuery(t).attr("id"); var o = jQuery(t).attr("class"); o && o.split(" ").map(function (e) { if (e.includes("iffy")) { var o = e.split("-"); if (3 === o.length) if ("city" === o[1] || "state" === o[1] || "country" === o[1]) iffy.useLocationTag(o[1], o[2]); else { var n = Cookies.get(o[1]); if (void 0 !== n) { n = JSON.parse(n); var a = ((new Date).getTime() - new Date(n.created_at).getTime()) / 1e3, i = void 0 !== n.delay && a > n.delay, r = n.loop || !n.hasShown; i && r && (n.hasShown = !0, Cookies.set(o[1], JSON.stringify(n)), n.value === o[2] && jQuery(t).toggleClass("hidden")) } } else if (2 === o.length && iffy.trackers.includes(o[1])) { var s = jQuery(t).children().contents().filter(function () { return 3 === this.nodeType }); jQuery.each(s, function (e, t) { var o = jQuery(t).text(), n = o.lastIndexOf("{{") + 2, a = o.lastIndexOf("}}"), i = o.substring(n, a); if ("" !== i) { var r = JSON.parse(Cookies.get(i.split(".")[0])), s = o.substring(0, n - 2) + r[i.split(".")[1]] + o.substring(a, o.length - 2); jQuery(this).parent().text(s) } }), jQuery(t).toggleClass("hidden") } } }) }) }, isFrom: function (e, t) { return new Promise(function (o, n) { iffy.waitToRunForJquery(function () { switch (e) { case iffy.locationTypes.STATE: iffy.address.address.state.toLowerCase() === t.toLowerCase() && o(!0), o(!1); break; case iffy.locationTypes.COUNTRY: iffy.address.address.country.toLowerCase() === t.toLowerCase() && o(!0), o(!1); break; case iffy.locationTypes.CITY: iffy.address.address.city.toLowerCase() === t.toLowerCase() && o(!0), o(!1) } }) }) }, waitToRunForJquery: function (e) { var t = setInterval(function () { iffy.hasJquery && (clearInterval(t), e()) }, 100) }, hasGeolocationAccess: function (e) { return iffy.attemptToloadJquery(), new Promise(function (e, t) { navigator.geolocation && navigator.geolocation.getCurrentPosition(function (t) { lat = t.coords.latitude, long = t.coords.longitude, iffy.waitToRunForJquery(function () { jQuery.ajax({ url: "https://nominatim.openstreetmap.org/reverse?format=json&lat=" + lat + "&lon=" + long + "&zoom=18&addressdetails=1", context: document.body }).then(function (t) { iffy.address = t, e(t) }) }) }) }) } }; (function (e, t) { e = e || "docReady"; var o = [], n = !1, a = !1; function i() { if (!n) { n = !0; for (var e = 0; e < o.length; e++)o[e].fn.call(window, o[e].ctx); o = [] } } function r() { "complete" === document.readyState && i() } (t = t || window)[e] = function (e, t) { if ("function" != typeof e) throw new TypeError("callback for docReady(fn) must be a function"); n ? setTimeout(function () { e(t) }, 1) : (o.push({ fn: e, ctx: t }), "complete" === document.readyState ? setTimeout(i, 1) : a || (document.addEventListener ? (document.addEventListener("DOMContentLoaded", i, !1), window.addEventListener("load", i, !1)) : (document.attachEvent("onreadystatechange", r), window.attachEvent("onload", i)), a = !0)) } })("docIsReady", iffy), iffy.getScript = function (e, t) { var o = document.createElement("script"); o.src = e; var n = document.getElementsByTagName("head")[0]; o.onload = o.onreadystatechange = function () { this.readyState && "loaded" != this.readyState && "complete" != this.readyState || (t(), o.onload = o.onreadystatechange = null, n.removeChild(o)) }, n.appendChild(o) }, iffy.attemptToloadJquery = function (e) { "undefined" == typeof jQuery && this.getScript(this.jqueryUrl, function () { "undefined" != typeof jQuery ? (iffy.hasJquery = !0, e()) : console.error(iffy.jqueryError) }), iffy.hasJquery = !0, e() }, iffy.whenReady = function (e) { return iffy.attemptToloadJquery(e || function () { }), this }, iffy.docIsReady(function () { iffy.attemptToloadJquery(iffy.go) }), iffy.go = function () { iffy.getScript("https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js", function () { iffy.callQueue.map(function (e) { e() }); var e = setInterval(function () { if (iffy.hasJquery) { clearInterval(e); var t = JSON.parse(Cookies.get("trackers")); void 0 === t ? t = [] : t.map(function (e) { iffy.trackers.includes(e) || iffy.trackers.push(e) }); var o = jQuery("[class^=iffy]"); iffy.elements = jQuery("[id^=iffy]").add(o), jQuery.each(iffy.elements, function (e, t) { jQuery(t).addClass("hidden") }), iffy.parseTemplates() } }, 25) }) }, iffy.track = function (e) { var t = !1, o = Cookies.get("trackers"), n = []; return void 0 !== o && (n = o.split(",")), "string" == typeof e ? (t = !0, iffy.trackers.includes(e) || iffy.trackers.push(e), n.includes(e) || n.push(e), iffy.addToCallQueue(function () { Cookies.set(e, !0) })) : Array.isArray(e) ? iffy.addToCallQueue(function () { t = !0, e.map(function (e) { n.push(e), iffy.trackers.push(e), Cookies.set(e, !0) }) }) : "object" == typeof e ? iffy.addToCallQueue(function () { t = !0, Object.keys(e).map(function (t) { n.push(t), iffy.trackers.includes(t) || iffy.trackers.push(t), e[t].created_at = new Date, e[t].hasShown = !1, e[t].loop = !!e[t].loop, Cookies.set(t, JSON.stringify(e[t]), { expires: 1800 }) }) }) : console.error("Unsupported Tracker Type."), iffy.addToCallQueue(function () { var e = JSON.stringify(n); Cookies.set("trackers", e) }), t }, iffy.hasTracker = function (e, t) { iffy.waitToRunForJquery(function () { var o = Cookies.get(e); if (void 0 !== o) { o = JSON.parse(o); var n = ((new Date).getTime() - new Date(o.created_at).getTime()) / 1e3, a = void 0 !== o.delay && n > o.delay, i = o.loop || !o.hasShown; a && i && (o.hasShown = !0, Cookies.set(e, JSON.stringify(o)), t()) } }) };